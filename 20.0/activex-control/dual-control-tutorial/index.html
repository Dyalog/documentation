
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../overview/">
      
      
        <link rel="next" href="../../dde/introduction/">
      
      
      <link rel="icon" href="../../img/favicon-32.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.15">
    
    
      
        <title>The Dual Control Tutorial - Interface Guide</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e359304.min.css">
      
      


    
    
      
    
    
      
        
        
        
        <link rel="stylesheet" href="../../assets/external/fonts.googleapis.com/css.2ebf2d53.css">
        <style>:root{--md-text-font:"Be Vietnam Pro";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../style/main.css">
    
      <link rel="stylesheet" href="../../style/extra.css">
    
      <link rel="stylesheet" href="../../style/admonition-ucmdhelp.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#methods" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Interface Guide" class="md-header__button md-logo" aria-label="Interface Guide" data-md-component="logo">
      
  <img src="../../img/dyalog-logo-2025_white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Interface Guide
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              The Dual Control Tutorial
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Interface Guide" class="md-nav__button md-logo" aria-label="Interface Guide" data-md-component="logo">
      
  <img src="../../img/dyalog-logo-2025_white.svg" alt="logo">

    </a>
    Interface Guide
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Introduction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/concepts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Concepts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/creating-objects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creating Objects
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/properties/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Properties
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/user-interaction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User Interaction and Events
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/methods/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Methods
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/high-priority-callbacks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    High-Priority Callback Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/gui-objects-as-namespaces/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GUI Objects as Namespaces
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/modal-dialog-boxes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modal Dialog Boxes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/multi-threading-with-objects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi Threading with Objects
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/the-cooordinate-system/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The Coordinate System
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/high-dpi-support/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    High DPI Support
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/colour/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Colour
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/fonts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fonts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/drag-and-drop/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Drag and Drop
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/debugging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Debugging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/creating-objects-using-new/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creating Objects using NEW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/native-look-and-feel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Native Look and Feel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/gestures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gestures
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    GUI Tutorial
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            GUI Tutorial
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui-tutorial/introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui-tutorial/some-concepts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Some Concepts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui-tutorial/creating-a-form/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creating a Form
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui-tutorial/adding-a-fahrenheit-label/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Adding a Fahrenheit Label
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui-tutorial/adding-a-fahrenheit-edit-field/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Adding a Fahrenheit Edit Field
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui-tutorial/adding-a-centigrade-label-edit-field/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Adding a Centigrade Label Edit Field
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui-tutorial/adding-calculate-buttons/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Adding Calculate Buttons
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui-tutorial/closing-the-application-window/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Closing the Application Window
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui-tutorial/adding-a-quit-button/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Adding a Quit Button
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui-tutorial/the-calculation-functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The Calculation Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui-tutorial/testing-the-application/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Testing the Application
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui-tutorial/making-the-enter-key-work/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Making the Enter Key Work
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui-tutorial/introducing-a-scrollbar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introducing a ScrollBar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui-tutorial/adding-a-menu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Adding a Menu
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui-tutorial/running-from-desktop/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Running from Desktop
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui-tutorial/using-new-instead-of-wc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using NEW instead of WC
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui-tutorial/temperature-converter-class/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Temperature Converter Class
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gui-tutorial/dual-class-example/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dual Class Example
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Graphics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Graphics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graphics/introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graphics/drawing-lines/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Drawing Lines
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graphics/drawing-in-a-bitmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Drawing in a Bitmap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graphics/multiple-graphical-items/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multiple Graphical Items
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graphics/unnamed-graphical-objects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Unnamed Graphical Objects
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graphics/bitmaps-and-icons/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bitmaps and Icons
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graphics/metafiles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metafiles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graphics/picture-buttons/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Picture Buttons
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graphics/using-icons/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using Icons
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Composite Controls
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Composite Controls
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../composite-controls/toolcontrol-and-toolbutton/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ToolControl and ToolButton Objects
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../composite-controls/coolbar-and-coolband-objects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CoolBar and CoolBand Objects
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../composite-controls/tabcontrol-and-tabbutton-objects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TabControl and TabButton Objects
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../composite-controls/statusbar-object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    StatusBar Object
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Hints and Tips
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Hints and Tips
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hints-and-tips/using-hints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using Hints
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hints-and-tips/using-tips/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using Tips
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hints-and-tips/hints-and-tips-combined/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hints and Tips Combined
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Grid Object
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Grid Object
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../grid-object/using-the-grid-object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using the Grid Object
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../grid-object/defining-overall-appearance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Defining Overall Appearance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../grid-object/row-and-column-titles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Row and Column Titles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../grid-object/displaying-and-editing-values-in-grid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Displaying and Editing Values in Grid Cells
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../grid-object/specifying-individual-cell-attributes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Specifying Individual Cell Attributes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../grid-object/drawing-graphics-on-a-grid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Drawing Graphics on a Grid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../grid-object/controlling-user-input/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Controlling User Input
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../grid-object/treeview-feature/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TreeView Feature
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../grid-object/grid-comments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Grid Comments
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    MDI
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            MDI
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mdi/introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multiple Document Interface Applications
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mdi/mdi-behaviour/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MDI Behaviour
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mdi/menus-in-mdi-applications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Menus in MDI Applications
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mdi/defining-a-window-menu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Defining a Window Menu
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mdi/arranging-child-forms-and-icons/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Arranging Child Forms and Icons
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Docking
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Docking
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../docking/introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../docking/docking-events/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docking Events
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../docking/docking-a-form-inside-another/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docking a Form inside another
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../docking/docking-a-form-into-a-coolbar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docking a Form into a CoolBar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../docking/undocking-a-subform-or-a-coolband/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Undocking a SubForm or a CoolBand
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../docking/docking-and-undocking-a-toolcontrol/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docking and Undocking a ToolControl
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    OLE Client
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            OLE Client
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ole-client/introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ole-client/using-an-ole-server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using an OLE Server
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ole-client/loading-an-activex-control/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Loading an ActiveX Control
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ole-client/type-information/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Type Information
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ole-client/methods/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Methods
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ole-client/properties/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Properties
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ole-client/events/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Events
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ole-client/ole-objects-without-type-information/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OLE Objects without Type Information
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ole-client/collections/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Collections
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ole-client/null-values/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Null Values
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ole-client/additional-interfaces/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Additional Interfaces
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ole-client/writing-classes-based-on-oleclient/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Writing Classes based on OLEClient
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    OLE Server
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            OLE Server
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ole-server/introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ole-server/in-process-ole-servers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    In process OLE Servers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ole-server/out-of-process-ole-servers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Out of process OLE Servers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ole-server/the-loan-workspace/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The LOAN Workspace
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ole-server/implementing-an-object-hierarchy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Implementing an Object Hierarchy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ole-server/the-cfiles-workspace/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The CFILES Workspace
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ole-server/configuring-an-out-of-process-oleserver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuring an out of process OLEServer for DCOM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ole-server/calling-an-ole-function-asynchronously/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Calling an OLE Function Asynchronously
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" checked>
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ActiveX Control
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            ActiveX Control
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    The Dual Control Tutorial
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    The Dual Control Tutorial
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    <span class="md-ellipsis">
      Methods
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#properties" class="md-nav__link">
    <span class="md-ellipsis">
      Properties
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#events" class="md-nav__link">
    <span class="md-ellipsis">
      Events
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introducing-the-dual-control" class="md-nav__link">
    <span class="md-ellipsis">
      Introducing the Dual Control
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preparing-a-working-directory" class="md-nav__link">
    <span class="md-ellipsis">
      Preparing a Working Directory
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    <span class="md-ellipsis">
      Getting Started
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#changing-dual-into-an-activex-control" class="md-nav__link">
    <span class="md-ellipsis">
      Changing Dual into an ActiveX Control
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-the-dual-control" class="md-nav__link">
    <span class="md-ellipsis">
      Testing the Dual Control
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#defining-and-exporting-properties" class="md-nav__link">
    <span class="md-ellipsis">
      Defining and Exporting Properties
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-properties-from-vb" class="md-nav__link">
    <span class="md-ellipsis">
      Setting Properties from VB
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#defining-and-exporting-events" class="md-nav__link">
    <span class="md-ellipsis">
      Defining and Exporting Events
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-events-from-vb" class="md-nav__link">
    <span class="md-ellipsis">
      Using Events from VB
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    DDE
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            DDE
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dde/introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dde/shared-variable-principles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Shared Variable Principles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dde/apl-and-dde-in-practice/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    APL and DDE in Practice
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dde/state-and-access-control/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    State and Access Control
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dde/example-communication-between-apls/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Communication Between APLs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dde/example-excel-as-the-server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Excel as the Server
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dde/example-excel-as-the-client/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Excel as the Client
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dde/example-apl-as-compute-server-for-excel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    APL as Compute Server for Excel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dde/restrictions-limitations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Restrictions and Limitations
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    <span class="md-ellipsis">
      Methods
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#properties" class="md-nav__link">
    <span class="md-ellipsis">
      Properties
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#events" class="md-nav__link">
    <span class="md-ellipsis">
      Events
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introducing-the-dual-control" class="md-nav__link">
    <span class="md-ellipsis">
      Introducing the Dual Control
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preparing-a-working-directory" class="md-nav__link">
    <span class="md-ellipsis">
      Preparing a Working Directory
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    <span class="md-ellipsis">
      Getting Started
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#changing-dual-into-an-activex-control" class="md-nav__link">
    <span class="md-ellipsis">
      Changing Dual into an ActiveX Control
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-the-dual-control" class="md-nav__link">
    <span class="md-ellipsis">
      Testing the Dual Control
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#defining-and-exporting-properties" class="md-nav__link">
    <span class="md-ellipsis">
      Defining and Exporting Properties
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-properties-from-vb" class="md-nav__link">
    <span class="md-ellipsis">
      Setting Properties from VB
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#defining-and-exporting-events" class="md-nav__link">
    <span class="md-ellipsis">
      Defining and Exporting Events
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-events-from-vb" class="md-nav__link">
    <span class="md-ellipsis">
      Using Events from VB
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 class="heading"><span class="name">The Dual Control Tutorial</span></h1>

<p>The ActiveX control we will use in this example is deliberately an extremely simple one; so that the intricacies of the control itself do not get in the way of the principles involved. In practice, there are actually very few restrictions concerning the complexity of the ActiveX control, and it is perfectly possible to package complete multiple-window Dyalog APL applications in this way.</p>
<p>Your ActiveX control will be called a <em>Dyalog Dual Control</em> and is based on the Dyalog APL TrackBar object.</p>
<p>The Dual control allows the user to enter a number using a slider, whilst displaying its value in two different units. For example, you could use it to enter a temperature value which is displayed in both Centigrade and Fahrenheit units. Equally, the same control could be used to enter a measurement of length which is concurrently displayed in centimetres and inches.</p>
<p><img alt="" src="../../img/dual-overview.png"></p>
<h2 id="methods">Methods</h2>
<p>None (the Dual control provides no methods.)</p>
<h2 id="properties">Properties</h2>
<p>The Dual control provides the following properties:</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Caption1</td>
<td>A text string that describes the primary units. This is displayed in the top left corner of the object.</td>
</tr>
<tr>
<td>Caption2</td>
<td>A text string that describes the secondary or derived units. This is displayed in the bottom left corner of the object.</td>
</tr>
<tr>
<td>Value1</td>
<td>The current value of the control measured in primary units</td>
</tr>
<tr>
<td>Value2</td>
<td>The current value of the control measured in secondary units.</td>
</tr>
<tr>
<td>Intercept</td>
<td>Used to derive Value2 from Value1</td>
</tr>
<tr>
<td>Gradient</td>
<td>Used to derive Value2 from Value1</td>
</tr>
<tr>
<td>Min</td>
<td>The minimum value of Value1</td>
</tr>
<tr>
<td>Max</td>
<td>The maximum value of Value1</td>
</tr>
</tbody>
</table>
<p>Value2 is derived from Value 1 using the expression:
</p><div class="highlight"><pre><span></span><code><span class="w">      </span><span class="nv">Value2</span><span class="kd"></span><span class="nv">Intercept</span><span class="o">+</span><span class="nv">Gradient</span><span class="o"></span><span class="nv">Value1</span>
</code></pre></div>
<h2 id="events">Events</h2>
<p>Your Dual control will generate a <em>ChangeValue1</em> event whenever the user alters Value1 using the slider.</p>
<p>The event message will contain a single parameter (the new value) which may be modified by the host application.</p>
<p>In other words, every time the value in the control changes, the host application may detect this as an event and has the opportunity to override the user.</p>
<p>Your Dual control will also generate a <em>ChangeValue2</em> event whenever the derived value in the control (Value2) changes. This event is reported for information only.</p>
<h2 id="introducing-the-dual-control">Introducing the Dual Control</h2>
<p>To save time, the basic APL code for the Dual control has already been written. Two workspaces are provided in the <code>samples\activex</code> subdirectory named <code>dualbase.dws</code> and <code>dualfns.dws</code>. You will use these workspaces to build the ActiveX control yourself.</p>
<h2 id="preparing-a-working-directory">Preparing a Working Directory</h2>
<p>To run this tutorial you will need to save files to a directory on your computer to which you have write access. This example uses a directory named <code>c:\MyWS</code>.</p>
<p>The directory is required to store the workspace and ActiveXControl, <code>Dual.ocx</code> as you develop them.</p>
<p>A Dyalog ActiveXControl uses  the dynamic-link library version of the Dyalog interpreter  which must be present in the same directory as the <code>.ocx</code> file, so you must copy the appropriate version here before you can start the tutorial. You may use either the Development DLL or the Run-Time DLL. If you choose to use the Development DLL, you will also need to copy the DyaRes DLL which it uses.</p>
<p>For the names of these files corresponding to the version of Dyalog that you are using, see <a href="../../../windows-installation-and-configuration-guide/files-and-directories">Files and Directories</a>.</p>
<div class="admonition note">
<p class="admonition-title">Start Dyalog as Administrator</p>
<p>Under Windows 7 and later, you have to have administrator privileges to register a COM component. Therefore, you must run Dyalog as administrator. If you fail to do this, the registration process will fail. If so, you can continue the process where you left off by closing Dyalog, restarting as administrator, and reloading the workspace.</p>
</div>
<h2 id="getting-started">Getting Started</h2>
<ul>
<li>
<p>Load the <code>samples\activex\dualbase.dws</code> workspace:
    </p><div class="highlight"><pre><span></span><code><span class="w">      </span><span class="p">)</span><span class="nv">LOAD</span><span class="w"> </span><span class="nv">dualbase</span>
<span class="nv">C</span><span class="bp">:</span><span class="na">\</span><span class="nv">Program</span><span class="w"> </span><span class="nv">Files</span><span class="w"> </span><span class="p">(</span><span class="nv">x86</span><span class="p">)</span><span class="na">\</span><span class="nv">Dyalog</span><span class="na">\</span><span class="nv">Dyalog</span><span class="w"> </span><span class="nv">APL</span><span class="w"> </span><span class="m">15.0</span><span class="w"> </span><span class="nv">Unicode</span><span class="na">\...</span>
</code></pre></div>
</li>
<li>
<p>Run the function <code>TEST</code> and observe how the 2 Dual controls behave.</p>
</li>
<li>
<p>View the function <code>TEST</code> and observe how 2 separate instances of the <code>Dual</code> namespace <code>F.D1</code> and <code>F.D2</code> have been created using <code>OR</code> and <code>NS</code>.</p>
</li>
<li>
<p>Using the Dyalog APL Workspace Explorer, open up the various namespaces. See how <code>F.D1</code> and <code>F.D2</code> are clones of <code>Dual</code>.</p>
</li>
<li>
<p>Open the function <code>Dual.Create</code> and see how the individual components of the control are defined.</p>
</li>
<li>
<p>Close the Form <code>F</code>.</p>
</li>
</ul>
<h2 id="changing-dual-into-an-activex-control">Changing Dual into an ActiveX Control</h2>
<p>Change the name of the workspace to Dual in a directory to which you have write-access:
</p><div class="highlight"><pre><span></span><code><span class="w">      </span><span class="p">)</span><span class="nv">WSID</span><span class="w"> </span><span class="nv">c</span><span class="bp">:</span><span class="na">\</span><span class="nv">MyWS</span><span class="na">\</span><span class="nv">Dual</span>
</code></pre></div>
<p>Make a new namespace called <code>F</code>
</p><div class="highlight"><pre><span></span><code><span class="w">      </span><span class="p">)</span><span class="nv">NS</span><span class="w"> </span><span class="nv">F</span>
</code></pre></div>
<p>Using the Workspace Explorer, move the <code>Dual</code> namespace into <code>F</code>, so that <code>Dual</code> is a child namespace of <code>F</code>.</p>
<p>Now edit the function <code>F.Dual.Create</code> and make the following changes:</p>
<p>Remove all references to the local variable <code>POSITION</code>. This change is required because an ActiveX control has no say in its position within its parent. (Hint: use the Search/Replace dialog to remove all occurrences of <code>POSITION+</code>)</p>
<p>Remove the right argument, <code>SIZE</code> and change <code>Create[1]</code> from:
</p><div class="highlight"><pre><span></span><code><span class="w">      </span><span class="nv">H</span><span class="w"> </span><span class="nv">W</span><span class="kd"></span><span class="nv">SIZE</span>
</code></pre></div>
<p>to
</p><div class="highlight"><pre><span></span><code><span class="w">      </span><span class="nv">H</span><span class="w"> </span><span class="nv">W</span><span class="kd"></span><span class="nv">Size</span>
</code></pre></div>
<p>This change allows the control to fit itself within the space allocated by the host application.</p>
<p>Change <code>Create[4]</code> from:
</p><div class="highlight"><pre><span></span><code><span class="w">      </span><span class="nv">CH</span><span class="kd"></span><span class="o"></span><span class="c1">##.GetTextSize 'W'</span>
</code></pre></div>
<p>to
</p><div class="highlight"><pre><span></span><code><span class="w">      </span><span class="nv">CH</span><span class="kd"></span><span class="o"></span><span class="nv">GetTextSize</span><span class="w"> </span><span class="s1">'W'</span>
</code></pre></div>
<p>The original code was designed to pick up the character height from the parent Form. The ActiveXControl object does this automatically via its own GetTextSize method.</p>
<p>After making these changes, the Create function should be as follows:
</p><div class="highlight"><pre><span></span><code><span class="w">     </span><span class="bp"></span><span class="w"> </span><span class="nv">Create</span><span class="sr">;</span><span class="nv">H</span><span class="sr">;</span><span class="nv">W</span><span class="sr">;</span><span class="nv">POS</span><span class="sr">;</span><span class="nv">SH</span><span class="sr">;</span><span class="nv">CH</span><span class="sr">;</span><span class="nv">Y1</span><span class="sr">;</span><span class="nv">Y2</span>
<span class="sr">[</span><span class="m">1</span><span class="sr">]</span><span class="w">    </span><span class="nv">H</span><span class="w"> </span><span class="nv">W</span><span class="kd"></span><span class="nv">Size</span>
<span class="sr">[</span><span class="m">2</span><span class="sr">]</span><span class="w">    </span><span class="nv">SH</span><span class="kd"></span><span class="m">40</span><span class="w"> </span><span class="c1"> Default TrackBar height</span>
<span class="sr">[</span><span class="m">3</span><span class="sr">]</span><span class="w">    </span><span class="nv">POS</span><span class="kd"></span><span class="m">2</span><span class="o"></span><span class="m">0.5</span><span class="o"></span><span class="m">0</span><span class="o"></span><span class="p">(</span><span class="nv">H</span><span class="o">-</span><span class="nv">SH</span><span class="p">)</span>
<span class="sr">[</span><span class="m">4</span><span class="sr">]</span><span class="w">    </span><span class="nv">CH</span><span class="kd"></span><span class="o"></span><span class="nv">GetTextSize</span><span class="s1">'W'</span>
<span class="sr">[</span><span class="m">5</span><span class="sr">]</span><span class="w">    </span><span class="s1">'Slider'</span><span class="nf">WC</span><span class="s1">'TrackBar'</span><span class="p">(</span><span class="nv">POS</span><span class="p">)(</span><span class="s1">'Size'</span><span class="nv">SH</span><span class="w"> </span><span class="nv">W</span><span class="p">)</span>
<span class="sr">[</span><span class="m">6</span><span class="sr">]</span><span class="w">    </span><span class="nv">Slider</span><span class="na">.</span><span class="p">(</span><span class="nv">Limits</span><span class="w"> </span><span class="nv">AutoConf</span><span class="p">)</span><span class="kd"></span><span class="p">(</span><span class="nv">Min</span><span class="o">,</span><span class="nv">Max</span><span class="p">)</span><span class="m">0</span>
<span class="sr">[</span><span class="m">7</span><span class="sr">]</span><span class="w">    </span><span class="nv">Slider</span><span class="na">.</span><span class="p">(</span><span class="nv">TickSpacing</span><span class="w"> </span><span class="nv">TickAlign</span><span class="p">)</span><span class="kd"></span><span class="m">10</span><span class="w"> </span><span class="s1">'Top'</span>
<span class="sr">[</span><span class="m">8</span><span class="sr">]</span><span class="w">    </span><span class="nv">Slider</span><span class="na">.</span><span class="nv">onThumbDrag</span><span class="kd"></span><span class="s1">'ChangeValue'</span>
<span class="sr">[</span><span class="m">9</span><span class="sr">]</span><span class="w">    </span><span class="nv">Slider</span><span class="na">.</span><span class="nv">onScroll</span><span class="kd"></span><span class="s1">'ChangeValue'</span>
<span class="sr">[</span><span class="m">10</span><span class="sr">]</span><span class="w">   </span><span class="nv">Y1</span><span class="kd"></span><span class="nv">POS</span><span class="sr">[</span><span class="m">1</span><span class="sr">]</span><span class="o">-</span><span class="nv">CH</span><span class="o">+</span><span class="m">1</span>
<span class="sr">[</span><span class="m">11</span><span class="sr">]</span><span class="w">   </span><span class="nv">Y2</span><span class="kd"></span><span class="nv">POS</span><span class="sr">[</span><span class="m">1</span><span class="sr">]</span><span class="o">+</span><span class="nv">SH</span><span class="o">+</span><span class="m">1</span>
<span class="sr">[</span><span class="m">12</span><span class="sr">]</span><span class="w">   </span><span class="s1">'Cap1'</span><span class="nf">WC</span><span class="s1">'Text'</span><span class="nv">Caption1</span><span class="p">(</span><span class="nv">Y1</span><span class="o">,</span><span class="m">0</span><span class="p">)(</span><span class="s1">'AutoConf'</span><span class="w"> </span><span class="m">0</span><span class="p">)</span>
<span class="sr">[</span><span class="m">13</span><span class="sr">]</span><span class="w">   </span><span class="s1">'Cap2'</span><span class="nf">WC</span><span class="s1">'Text'</span><span class="nv">Caption2</span><span class="p">(</span><span class="nv">Y2</span><span class="o">,</span><span class="m">0</span><span class="p">)(</span><span class="s1">'AutoConf'</span><span class="w"> </span><span class="m">0</span><span class="p">)</span>
<span class="sr">[</span><span class="m">14</span><span class="sr">]</span><span class="w">   </span><span class="s1">'V1'</span><span class="nf">WC</span><span class="s1">'Text'</span><span class="p">(</span><span class="o"></span><span class="nv">Value1</span><span class="p">)(</span><span class="nv">Y1</span><span class="o">,</span><span class="nv">W</span><span class="p">)</span>
<span class="w">                    </span><span class="p">(</span><span class="s1">'HAlign'</span><span class="w"> </span><span class="m">2</span><span class="p">)(</span><span class="s1">'AutoConf'</span><span class="w"> </span><span class="m">0</span><span class="p">)</span>
<span class="sr">[</span><span class="m">15</span><span class="sr">]</span><span class="w">   </span><span class="nv">CalcValue2</span>
<span class="sr">[</span><span class="m">16</span><span class="sr">]</span><span class="w">   </span><span class="s1">'V2'</span><span class="nf">WC</span><span class="s1">'Text'</span><span class="p">(</span><span class="o"></span><span class="nv">Value2</span><span class="p">)(</span><span class="nv">Y2</span><span class="o">,</span><span class="nv">W</span><span class="p">)</span>
<span class="w">                    </span><span class="p">(</span><span class="s1">'HAlign'</span><span class="w"> </span><span class="m">2</span><span class="p">)(</span><span class="s1">'AutoConf'</span><span class="w"> </span><span class="m">0</span><span class="p">)</span>
<span class="w">     </span><span class="bp"></span>
</code></pre></div>
<p>Open the function <code>F.Dual.Build</code>. This function turns the Dual's parent namespace into a Form (an ActiveXControl  requires a parent Form) and turns Dual itself into an ActiveXControl. It then attaches functions Create and Configure as callbacks on the Create and Configure events of the ActiveXControl object itself.
</p><div class="highlight"><pre><span></span><code><span class="w">     </span><span class="bp"></span><span class="w"> </span><span class="nv">Build</span>
<span class="sr">[</span><span class="m">1</span><span class="sr">]</span><span class="w">    </span><span class="c1">##.WC'Form'('Coord' 'Pixel')('KeepOnClose' 1)</span>
<span class="sr">[</span><span class="m">2</span><span class="sr">]</span><span class="w">    </span><span class="nf">WC</span><span class="s1">'ActiveXControl'</span><span class="p">(</span><span class="s1">'Size'</span><span class="w"> </span><span class="m">80</span><span class="w"> </span><span class="m">200</span><span class="p">)</span>
<span class="w">                          </span><span class="p">(</span><span class="s1">'KeepOnClose'</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
<span class="sr">[</span><span class="m">3</span><span class="sr">]</span><span class="w">    </span><span class="nf">WS</span><span class="s1">'Event'</span><span class="w"> </span><span class="s1">'Create'</span><span class="w"> </span><span class="s1">'Create'</span>
<span class="sr">[</span><span class="m">4</span><span class="sr">]</span><span class="w">    </span><span class="nf">WS</span><span class="s1">'Event'</span><span class="w"> </span><span class="s1">'Configure'</span><span class="w"> </span><span class="s1">'Configure'</span>
<span class="sr">[</span><span class="m">5</span><span class="sr">]</span><span class="w">    </span><span class="nf">NQ</span><span class="s1">''</span><span class="w"> </span><span class="s1">'Create'</span>
<span class="w">     </span><span class="bp"></span>
</code></pre></div>
<p>Run function <code>F.Dual.Build</code>. You should see a Form containing a single instance of the Dual control. Please resist any temptation to play with it at this stage; we want it to be in its default state for when we save it.</p>
<p>Type the following expression; note that the ClassID, which uniquely identifies your control (and so will not be the same as that shown below), is allocated when you create the ActiveXControl object.
</p><div class="highlight"><pre><span></span><code><span class="w">        </span><span class="nv">F</span><span class="na">.</span><span class="nv">Dual</span><span class="na">.</span><span class="nv">ClassID</span>
<span class="kt">{</span><span class="m">002</span><span class="nv">F9614</span><span class="o">-</span><span class="m">50</span><span class="nv">F7</span><span class="o">-</span><span class="m">4</span><span class="nv">F3B</span><span class="o">-</span><span class="nv">BB0B</span><span class="o">-</span><span class="nv">FA3316964E78</span><span class="kt">}</span>
</code></pre></div>
<p>Save the workspace (<code>c:\MyWS\Dual.dws</code>).</p>
<p>From the Session <em>File</em> menu, select <em>Export</em>, choose where you want to save your OCX, and then click Save. It is a good idea to clear the <em>Runtime application</em> checkbox so that you can debug the control if anything goes wrong.</p>
<p><img alt="" src="../../img/dual-export.png"></p>
<p><img alt="" src="../../img/dual-export-1.png"></p>
<h2 id="testing-the-dual-control">Testing the Dual Control</h2>
<p>This section describes how you can test and exercise the Dual control using any appropriate version of Microsoft Visual Studio, such as Microsoft Visual Studio Community 2015, and  language (e.g. Visual Basic) of your choice. This tool is henceforth referred to herein as VB.</p>
<ul>
<li>Start VB and create a new <em>Windows Forms Application Project</em>.</li>
<li>Click the right mouse button in the General section of the Toolbox window and select  <em>Choose Items ...</em> from the pop-up menu. In the <em>Choose Toolbox Items</em> dialog box, click the <em>COM Components</em> tab.</li>
<li>Locate the control named <em>Dyalog Dual Control</em>, enable its check box and click <em>OK</em>. This adds a tool for the Dual control to the VB Toolbox.</li>
<li>Click on the new tool and drag it onto your Form. An instance of the Dual control will appear.</li>
<li>Repeat this step to position a second instance of the Dual control on your VB Form.</li>
<li>Click the <em>Start Debugging</em> button.</li>
<li>Exercise the two Dual controls.</li>
<li>Click the <em>Stop Debugging</em> button.</li>
<li>Click on one of the Dual controls and scroll through its Property list. Notice that all the properties listed are standard VB ones; there are no properties (or indeed methods and events) exported. We will learn how to do this next.</li>
</ul>
<p>Close but <strong>do not</strong> save the project.</p>
<h2 id="defining-and-exporting-properties">Defining and Exporting Properties</h2>
<p>Back in the Dyalog Session, change space into the <code>F.Dual</code> namespace.
</p><div class="highlight"><pre><span></span><code><span class="w">      </span><span class="p">)</span><span class="nv">CS</span><span class="w"> </span><span class="nv">F</span><span class="na">.</span><span class="nv">Dual</span>
</code></pre></div>
<p>The properties we wish to export are:</p>
<table>
    <tr>
        <td>Caption1</td>
        <td>Description of the primary set of units</td>
    </tr>
    <tr>
        <td>Caption2</td>
        <td>Description of the secondary set of units</td>
    </tr>
    <tr>
        <td>Value1</td>
        <td>The primary value in the control</td>
    </tr>
    <tr>
        <td>Min</td>
        <td>Minimum for Value1</td>
    </tr>
    <tr>
        <td>Max</td>
        <td>Maximum for Value1</td>
    </tr>
    <tr>
        <td>Intercept</td>
        <td>Used to derive the secondary value (Value2)</td>
    </tr>
    <tr>
        <td>Gradient</td>
        <td>Used to derive the secondary value (Value2)</td>
    </tr>
</table>

<p>Although we could export all these properties as variables, it is generally more useful to employ <em>Get</em> and <em>Put</em> functions. The reason for this is that there is no mechanism to detect when the host application changes a property/variable; nor is there any mechanism to prevent it assigning an inappropriate value. The <em>Get</em> and <em>Put</em> functions you need are listed below. To save you time, you can copy them in from the workspace <code>samples\activex\dualfns.dws</code>.
</p><div class="highlight"><pre><span></span><code><span class="w">      </span><span class="p">)</span><span class="nv">COPY</span><span class="w"> </span><span class="nv">dualfns</span>
<span class="nv">C</span><span class="bp">:</span><span class="na">\</span><span class="nv">Program</span><span class="w"> </span><span class="nv">Files</span><span class="w"> </span><span class="p">(</span><span class="nv">x86</span><span class="p">)</span><span class="na">\</span><span class="nv">Dyalog</span><span class="na">\</span><span class="nv">Dyalog</span><span class="w"> </span><span class="nv">APL</span><span class="w"> </span><span class="m">15.0</span><span class="w"> </span><span class="nv">Unicode</span><span class="na">\...</span>

<span class="w">     </span><span class="bp"></span><span class="w"> </span><span class="nv">R</span><span class="kd"></span><span class="nv">GetCaption1</span>
<span class="sr">[</span><span class="m">1</span><span class="sr">]</span><span class="w">    </span><span class="nv">R</span><span class="kd"></span><span class="nv">Caption1</span>

<span class="w">     </span><span class="bp"></span><span class="w"> </span><span class="nv">SetCaption1</span><span class="w"> </span><span class="nv">C</span>
<span class="sr">[</span><span class="m">1</span><span class="sr">]</span><span class="w">    </span><span class="nv">Cap1</span><span class="na">.</span><span class="nv">Text</span><span class="kd"></span><span class="nv">Caption1</span><span class="kd"></span><span class="nv">C</span>

<span class="w">     </span><span class="bp"></span><span class="w"> </span><span class="nv">R</span><span class="kd"></span><span class="nv">GetCaption2</span>
<span class="sr">[</span><span class="m">1</span><span class="sr">]</span><span class="w">    </span><span class="nv">R</span><span class="kd"></span><span class="nv">Caption2</span>

<span class="w">     </span><span class="bp"></span><span class="w"> </span><span class="nv">SetCaption2</span><span class="w"> </span><span class="nv">C</span>
<span class="sr">[</span><span class="m">1</span><span class="sr">]</span><span class="w">    </span><span class="nv">Cap2</span><span class="na">.</span><span class="nv">Text</span><span class="kd"></span><span class="nv">Caption2</span><span class="kd"></span><span class="nv">C</span>

<span class="w">     </span><span class="bp"></span><span class="w"> </span><span class="nv">R</span><span class="kd"></span><span class="nv">GetIntercept</span>
<span class="sr">[</span><span class="m">1</span><span class="sr">]</span><span class="w">    </span><span class="nv">R</span><span class="kd"></span><span class="nv">Intercept</span>

<span class="w">     </span><span class="bp"></span><span class="w"> </span><span class="nv">SetIntercept</span><span class="w"> </span><span class="nv">I</span>
<span class="sr">[</span><span class="m">1</span><span class="sr">]</span><span class="w">    </span><span class="nv">Intercept</span><span class="kd"></span><span class="nv">I</span>
<span class="sr">[</span><span class="m">2</span><span class="sr">]</span><span class="w">    </span><span class="nv">CalcValue2</span>
<span class="sr">[</span><span class="m">3</span><span class="sr">]</span><span class="w">    </span><span class="nv">V2</span><span class="na">.</span><span class="nv">Text</span><span class="kd"></span><span class="o"></span><span class="nv">Value2</span>

<span class="w">     </span><span class="bp"></span><span class="w"> </span><span class="nv">R</span><span class="kd"></span><span class="nv">GetGradient</span>
<span class="sr">[</span><span class="m">1</span><span class="sr">]</span><span class="w">    </span><span class="nv">R</span><span class="kd"></span><span class="nv">Gradient</span>

<span class="w">     </span><span class="bp"></span><span class="w"> </span><span class="nv">SetGradient</span><span class="w"> </span><span class="nv">G</span>
<span class="sr">[</span><span class="m">1</span><span class="sr">]</span><span class="w">    </span><span class="nv">Gradient</span><span class="kd"></span><span class="nv">G</span>
<span class="sr">[</span><span class="m">2</span><span class="sr">]</span><span class="w">    </span><span class="nv">CalcValue2</span>
<span class="sr">[</span><span class="m">3</span><span class="sr">]</span><span class="w">    </span><span class="nv">V2</span><span class="na">.</span><span class="nv">Text</span><span class="kd"></span><span class="o"></span><span class="nv">Value2</span>

<span class="w">     </span><span class="bp"></span><span class="w"> </span><span class="nv">R</span><span class="kd"></span><span class="nv">GetValue1</span>
<span class="sr">[</span><span class="m">1</span><span class="sr">]</span><span class="w">    </span><span class="nv">R</span><span class="kd"></span><span class="nv">Value1</span>

<span class="w">     </span><span class="bp"></span><span class="w"> </span><span class="nv">SetValue1</span><span class="w"> </span><span class="nv">V</span>
<span class="sr">[</span><span class="m">1</span><span class="sr">]</span><span class="w">    </span><span class="m">1</span><span class="w"> </span><span class="nf">NQ</span><span class="s1">''</span><span class="w"> </span><span class="s1">'ChangeValue'</span><span class="nv">V</span>
</code></pre></div>
<p>The <code>Get</code> functions need no explanation; they simply return the value of the corresponding variable. The <code>Set</code> functions assign a new value to the corresponding variable and update the control accordingly. <code>SetValue1</code> does this by enqueuing a Scroll event to the Slider, which in turn invokes the <code>ChangeValue</code> callback.</p>
<p>Display the <em>Object Properties</em> dialog box for the function <code>GetCaption1</code>. (Hint: use the Workspace Explorer).</p>
<p>Select the <em>COM Properties</em> tab. As you have not yet defined any OLE attributes, the default display is as follows:</p>
<p><img alt="" src="../../img/dual-getcaption1-a.png"></p>
<p>Check the <em>Exported</em> option button.</p>
<p>Change the data type for the <em>Result</em> to VT_BSTR (a text string).</p>
<p>Check the <em>Prop Get</em> radio button to indicate that this is a <em>Property Get</em> function and enter the name of the property (<code>Caption1</code>) to which it applies.</p>
<p>Note that it is not necessary for the property name referenced by the <em>Get</em> and <em>Put</em> functions to correspond to a variable name, although in this case it does.</p>
<p>The final <em>COM Properties</em> dialog box for <code>GetCaption1</code> should appear as follows. Click <em>OK</em> to save your changes.</p>
<p><img alt="" src="../../img/dual-getcaption1-b.png"></p>
<p>Now do the same for the <code>SetCaption1</code> function. This function takes an argument which it expects to be a character vector. It must therefore be defined as having a single parameter of data type VT_BSTR; the parameter name is unimportant. However, you must ensure that the <em>Optional</em> button is unchecked.</p>
<p>In APL terms, the function does not return a result. However, in OLE terms the result is defined to be of type VT_VOID. Alternatively, you may just leave this field empty.</p>
<p>The OLE properties for <code>SetCaption1</code> should appear as follows:</p>
<p><img alt="" src="../../img/dual-setcaption1.png"></p>
<p>An alternative way to define the syntax for exported functions is to use the <em>COM Functions</em> tab in the Properties dialog box for the ActiveXControl object itself. (Hint: using the Workspace Explorer, open <code>F</code> so that its contents, <code>Dual</code>, are displayed in the right-hand list, select <code>Dual</code>, then click <em>Props</em>).</p>
<p>The <em>COM Functions</em> tab should appear as follows:</p>
<p><img alt="" src="../../img/dual-com-functions-a.png"></p>
<p>The right-hand Combo box allows you to view and edit their syntax for the exported functions you have already defined. The left-hand Combo box displays the list of other non-exported functions that are defined in the ActiveXControl.</p>
<p>Select <code>GetCaption2</code> from the left-hand Combo box, and then click <em>Add</em>. The dialog box will change to display the default syntax for <code>GetCaption2</code>. Alter the <em>Result</em> data type to VT_BSTR, select <em>Prop Get</em>, and enter the name of the property, <code>Caption2</code>, so that the dialog box appears as follows:</p>
<p><img alt="" src="../../img/dual-com-functions-b.png"></p>
<p>The third way to define the syntax for exported functions is to use the SetFnInfo method of the ActiveXControl object. This allows you to export functions using APL code, which in some circumstances may be more convenient than filling in dialog boxes.</p>
<p>The SetFnInfo method requires the name of the function, its syntax, a help id, a code which specifies its type (0 = method, 2 = property get, 4 = property put) and, if appropriate, the name of the property to which it applies, that is
</p><div class="highlight"><pre><span></span><code><span class="w">      </span><span class="nv">SetFnInfo</span><span class="w"> </span><span class="nv">fn</span><span class="w"> </span><span class="nv">syntax</span><span class="w"> </span><span class="nv">helpid</span><span class="w"> </span><span class="nv">type</span><span class="w"> </span><span class="nv">property</span>
</code></pre></div>
<p>The function <code>syntax</code> is a nested array whose first element defines the function's result and whose subsequent elements define each of its parameters. Each syntax specifier is a single character string that defines a data type, or a pair of character strings. If so, the first string for the result defines a help string, and the first string for each parameter defines its name.</p>
<p>The following table describes the information we must specify for each of the functions to be exported:</p>
<p><strong>Exported Functions</strong></p>
<table>
    <tr>
        <th rowspan="2">Function</th>
        <th rowspan="2">Result</th>
        <th colspan="2">Parameter</th>
        <th rowspan="2">Get/Put</th>
        <th rowspan="2">Property</th>
    </tr>
    <tr>
        <th>Name</th>
        <th>Type</th>
    </tr>
    <tr>
        <td>GetCaption1</td>
        <td>VT_BSTR</td>
        <td></td>
        <td></td>
        <td>Get(2)</td>
        <td>Caption1</td>
    </tr>
    <tr>
        <td>GetCaption2</td>
        <td>VT_BSTR</td>
        <td></td>
        <td></td>
        <td>Get(2)</td>
        <td>Caption2</td>
    </tr>
    <tr>
        <td>GetGradient</td>
        <td>VT_R8</td>
        <td></td>
        <td></td>
        <td>Get(2)</td>
        <td>Gradient</td>
    </tr>
    <tr>
        <td>GetIntercept</td>
        <td>VT_R8</td>
        <td></td>
        <td></td>
        <td>Get(2)</td>
        <td>Intercept</td>
    </tr>
    <tr>
        <td>GetValue1</td>
        <td>VT_I4</td>
        <td></td>
        <td></td>
        <td>Get(2)</td>
        <td>Value1</td>
    </tr>
    <tr>
        <td>SetCaption1</td>
        <td>VT_VOID</td>
        <td>Caption1</td>
        <td>VT_BSTR</td>
        <td>Put(4)</td>
        <td>Caption1</td>
    </tr>
    <tr>
        <td>SetCaption2</td>
        <td>VT_VOID</td>
        <td>Caption2</td>
        <td>VT_BSTR</td>
        <td>Put(4)</td>
        <td>Caption2</td>
    </tr>
    <tr>
        <td>SetGradient</td>
        <td>VT_VOID</td>
        <td>Gradient</td>
        <td>VT_R8</td>
        <td>Put(4)</td>
        <td>Gradient</td>
    </tr>
    <tr>
        <td>SetIntercept</td>
        <td>VT_VOID</td>
        <td>Intercept</td>
        <td>VT_R8</td>
        <td>Put(4)</td>
        <td>Intercept</td>
    </tr>
    <tr>
        <td>SetValue1</td>
        <td>VT_VOID</td>
        <td>Value1</td>
        <td>VT_I4</td>
        <td>Put(4)</td>
        <td>Value1</td>
    </tr>
</table>

<p>From this table we can easily construct the corresponding SetFnInfo statements. For example, the statement for <code>GetCaption1</code> is:
</p><div class="highlight"><pre><span></span><code><span class="w">      </span><span class="nv">SetFnInfo</span><span class="w"> </span><span class="s1">'GetCaption1'</span><span class="w"> </span><span class="s1">'VT_BSTR'</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="s1">'Caption1'</span>
</code></pre></div>
<p>Note that <code>1</code> in the 3<sup>rd</sup> element of the right argument specifies that there is no help id.</p>
<p>Open the function <code>F.Dual.EXPORT</code>; this contains statements to export all the <em>Get</em> and <em>Put</em> functions we need.</p>
<p>Run the function and save the workspace.
</p><div class="highlight"><pre><span></span><code><span class="w">      </span><span class="p">)</span><span class="nv">CS</span>
<span class="c1">#</span>
<span class="w">      </span><span class="nv">F</span><span class="na">.</span><span class="nv">Dual</span><span class="na">.</span><span class="nv">EXPORT</span>
<span class="w">            </span><span class="p">)</span><span class="nv">SAVE</span>
<span class="nv">c</span><span class="bp">:</span><span class="na">\</span><span class="nv">MyWS</span><span class="na">\</span><span class="nv">Dual</span><span class="na">.</span><span class="nv">dws</span><span class="w"> </span><span class="nv">saved</span><span class="w"> </span><span class="nv">Mon</span><span class="w"> </span><span class="nv">Aug</span><span class="w">  </span><span class="m">1</span><span class="w"> </span><span class="m">14</span><span class="bp">:</span><span class="m">52</span><span class="bp">:</span><span class="m">14</span><span class="w"> </span><span class="m">2016</span>
</code></pre></div>
<p>Then, re-export the workspace, updating your <code>.ocx</code> file with all the new information.</p>
<p><img alt="" src="../../img/dual-export-2.png"></p>
<h2 id="setting-properties-from-vb">Setting Properties from VB</h2>
<p>Start VB and create a new Windows Forms Application Project.</p>
<p>If the Dyalog Dual Control is not already in the Toolbox, click the right mouse button in the General section of the Toolbox window and select  <em>Choose Items ...</em> from the pop-up menu. In the <em>Choose Toolbox Items</em> dialog box, click the <em>COM Components</em> tab.</p>
<p>Locate the control named <em>Dyalog DUAL Control</em>, enable its checkbox and click <em>OK</em>. This adds a tool for the Dual control to the VB Toolbox.</p>
<p>Click on the Dyalog Dual tool and drag it onto your Form. An instance of the Dual control will appear.</p>
<p>In the Properties dialog box, change the default Dual1 properties to the following:</p>
<table>
    <tr>
        <td>Caption1</td>
        <td>Centimetres</td>
    </tr>
    <tr>
        <td>Caption2</td>
        <td>Inches</td>
    </tr>
    <tr>
        <td>Gradient</td>
        <td>0.3937</td>
    </tr>
    <tr>
        <td>Intercept</td>
        <td>0</td>
    </tr>
</table>

<p>Double-click the left mouse button over your Form (<em>Form1</em>). This will bring up the code editor dialog box. Edit the <code>Form1_Load()</code> subroutine, entering the program statements shown below. This code will be run when VB starts your application and loads the Form <em>Form1</em>. It illustrates how you can change the properties of your Dyalog APL ActiveX control dynamically.</p>
<p><img alt="" src="../../img/dual-form1-load-1.png"></p>
<p>Now test your application by clicking <em>Start Debugging</em>. When you have finished, click  <em>Stop Debugging</em>.</p>
<p>Close but <strong>do not</strong> save the project. This is necessary to allow you to rebuild the Dual ActiveX control which is (currently) loaded in your VB application. Otherwise, Dyalog will be unable to overwrite the <code>.ocx</code> file.</p>
<h2 id="defining-and-exporting-events">Defining and Exporting Events</h2>
<p>Back in Dyalog, using the Workspace Explorer, open the callback function <code>F.Dual.ChangeValue</code> and alter <code>ChangeValue[2]</code> from:
</p><div class="highlight"><pre><span></span><code><span class="w">    </span><span class="nv">Value1</span><span class="kd"></span><span class="o"></span><span class="m">1</span><span class="o"></span><span class="nv">MSG</span>
</code></pre></div>
<p>to
</p><div class="highlight"><pre><span></span><code><span class="w">    </span><span class="nv">Value1</span><span class="kd"></span><span class="o"></span><span class="m">4</span><span class="w"> </span><span class="nf">NQ</span><span class="w"> </span><span class="s1">''</span><span class="w"> </span><span class="s1">'ChangeValue1'</span><span class="w"> </span><span class="p">(</span><span class="o"></span><span class="m">1</span><span class="o"></span><span class="nv">MSG</span><span class="p">)</span>
</code></pre></div>
<p>Then close the function. Previously, the <code>ChangeValue</code> function simply accepted the new value (of the TrackBar thumb) that it received as the last element of the event message. Now it generates an external ChangeValue1 event for the host application using <code>4 NQ</code>. The host may in turn modify the new value which is returned as the result of the expression. Thus, not only can Dyalog APL generate events which are detectable by the host application, it can also accept modifications.</p>
<p>Again using the Workspace Explorer, open the Properties dialog box for the Dual object itself and select the <em>COM Events</em> tab.</p>
<p>Enter the name of the event <code>ChangeValue1</code> into the edit box labelled <em>Name</em>.</p>
<p>Click <em>Add</em></p>
<p>Click the right mouse button over the <em>Result</em> row and select <em>Insert</em></p>
<p>In the column labelled <em>Param Name</em> enter  <code>Value1</code>, then change the <em>Type</em> to VT_I4 and the <em>Modifier</em> to VT_PTR. This defines a parameter named <code>Value1</code> that supplies a pointer to an integer. The fact that it is a <em>pointer</em> means that the (integer) parameter may be modified by the host application.</p>
<p>The final appearance of this dialog box should be as follows:</p>
<p><img alt="" src="../../img/dual-com-events.png"></p>
<p>Click <em>OK</em>, change back to the root space, and save the workspace.
</p><div class="highlight"><pre><span></span><code><span class="w">      </span><span class="p">)</span><span class="nv">CS</span><span class="w"> </span><span class="c1">#</span>
<span class="w">      </span><span class="p">)</span><span class="nv">SAVE</span>
</code></pre></div>
<p>Select <em>File/Export</em> and rebuild your <code>.ocx</code> file.</p>
<p><img alt="" src="../../img/dual-com-events-1.png"></p>
<h2 id="using-events-from-vb">Using Events from VB</h2>
<p>Back in VB, create a new Windows Application Project.</p>
<p>Check that the <em>Dyalog DUAL Control</em> tool is available in the ToolBox.</p>
<p>If not:</p>
<ul>
<li>click the right mouse button in the General section of the Toolbox window and select  <em>Choose Items ...</em> from the pop-up menu. In the <em>Choose Toolbox Items</em> dialog box, click the <em>COM Components</em> tab.</li>
<li>locate the control named <em>Dyalog DUAL Control</em>, set its checkbox on and click <em>OK</em>. This adds a tool for the Dual control to the VB Toolbox.</li>
</ul>
<p>Click on the <em>Dyalog DUAL Control</em> tool and drag it onto your Form. An instance of the Dual control will appear.</p>
<p>Select the label tool and add a label object (<em>Label1</em>) to the Form. Select its Font property and change it to 14-point bold.</p>
<p><img alt="" src="../../img/dual-com-events-2.png"></p>
<p>View the code window and choose the object AxDual1 and its only event ChangeValue1. Enter a line of code to set the Caption property of the Label object Label1 to the String equivalent of the event parameter Value1.</p>
<p>Enter the following code, and then close the code window, that is
</p><div class="highlight"><pre><span></span><code><span class="nv">Label1</span><span class="na">.</span><span class="nv">Text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Str</span><span class="p">(</span><span class="nv">e</span><span class="na">.</span><span class="nv">Value1</span><span class="p">)</span>
</code></pre></div>
<p><img alt="" src="../../img/dual-com-events-3.png"></p>
<p>Start the application using <em>Start Debugging</em>. Exercise the Dual control and observe that VB updates the Label1 control in response to the ChangeValue1 events. When you have finished, select <em>Stop Debugging</em>.</p>
<p><img alt="" src="../../img/dual-com-events-4.png"></p>
<p>In the code window, add the following line of code to the <code>AxDual1_ChangeValue</code> subroutine:
</p><div class="highlight"><pre><span></span><code><span class="nv">e</span><span class="na">.</span><span class="nv">Value1</span><span class="o">=</span><span class="m">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="nv">e</span><span class="na">.</span><span class="nv">Value1</span><span class="na">\</span><span class="m">2</span><span class="p">)</span>
</code></pre></div>
<p><img alt="" src="../../img/dual-com-events-5.png"></p>
<p>Start the application using <em>Start Debugging</em>. Exercise the Dual control and observe that now the slider moves in increments of 2. When you have finished, select <em>Stop Debugging</em></p>
<p><img alt="" src="../../img/dual-com-events-6.png"></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.path", "navigation.indexes"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.bd41221c.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="../../https:/polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="../../assets/external/unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../assets/external/unpkg.com/mermaid@10.7.0/dist/mermaid.min.js"></script>
      
    
  </body>
</html>